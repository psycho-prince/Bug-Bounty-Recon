name: Bug-Bounty-Recon-Optimized

on:
  workflow_dispatch: # Allows manual trigger
  schedule:
    - cron: '0 0 * * *' # Runs daily at midnight

jobs:
  recon:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Set up Go
        uses: actions/setup-go@v4
        with:
          go-version: '1.21'

      - name: Install Tools
        run: |
          go install github.com/ffuf/ffuf/v2@latest
          go install -v github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest
          pip install arjun

      - name: Targeted FFUF Discovery
        # Prioritizing the target where you found favicon.ico
        run: |
          ffuf -w wordlist.txt \
               -u https://discord.verify.openai.com/FUZZ \
               -mc 200,301,403 \
               -t 50 \
               -o ffuf_discord_results.json

      - name: Nuclei Scan (High-Value Targets)
        # Specifically targeting verified live 200/403 endpoints found in live.txt
        run: |
          echo "https://alignment.openai.com" > high_value_targets.txt
          echo "https://auth.enterpriseservices.openai.com" >> high_value_targets.txt
          echo "https://discord.verify.openai.com" >> high_value_targets.txt
          echo "https://evals.openai.com" >> high_value_targets.txt
          
          nuclei -l high_value_targets.txt -severity high,critical -o nuclei_results.txt

      - name: Arjun Parameter Discovery
        # Optimized Arjun to prevent the 51-minute timeout you experienced
        run: |
          arjun -u https://alignment.openai.com --stable --rate 10 -oJ arjun_results.json

      - name: Save & Commit Results
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add *.json *.txt
          git commit -m "Update Recon Results: $(date)" || echo "No changes to commit"
          git push
          
