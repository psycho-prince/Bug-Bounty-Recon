name: OpenAI-Infrastructure-Full-Goldmine
on:
  workflow_dispatch:

jobs:
  exploit-hunt:
    runs-on: ubuntu-latest
    steps:
      - name: Install Arsenal
        run: |
          go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest
          go install -v github.com/projectdiscovery/httpx/cmd/httpx@latest
          go install -v github.com/projectdiscovery/katana/cmd/katana@latest
          go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest
          go install -v github.com/lc/gau/v2/cmd/gau@latest
          pip install arjun
          sudo mv ~/go/bin/* /usr/local/bin/

      - name: Recon:Target Identification
        run: |
          # 1. Scope based on OpenAI's 'Gold' targets
          echo "openai.com" > scope.txt
          echo "api.openai.com" >> scope.txt
          echo "openai.org" >> scope.txt
          
          # 2. Find every possible subdomain and live host
          subfinder -dL scope.txt -silent -o subdomains.txt
          httpx -l subdomains.txt -silent -o live_targets.txt

      - name: Deep Mining:API & Web Logic
        run: |
          # 3. Use Katana for Deep Spidering (JS bundles and API paths)
          katana -list live_targets.txt -jc -kf all -d 4 -ratelimit 2 -o all_endpoints.txt
          
          # 4. Extract 'Gold' targets (BOLA/IDOR prone paths)
          grep -E "/v[0-9]/|admin|billing|org-|uuid|checkout" all_endpoints.txt > priority_targets.txt
          
          # 5. Search for unreleased codenames in JS (The 'Quick' Bounty)
          grep -Ei "arrakis|gobi|tiara|internal-api|preview-feature" all_endpoints.txt > unreleased_intel.txt

      - name: "CRITICAL: Automated Vulnerability Fetcher"
        run: |
          # 6. Nuclei: Focus on Exposures and Cloud Leaks (Azure Blobs/Keys)
          nuclei -l priority_targets.txt -t exposures/ -t vulnerabilities/ -severity critical,high -rate-limit 2 -o nuclei_results.txt
          
          # 7. Arjun: Fuzz for hidden 'admin' or 'debug' parameters on API endpoints
          head -n 5 priority_targets.txt | while read -r url; do
             arjun -u "$url" --rate-limit 1 -oJ "params_$(date +%s).json"
          done

      - name: Archive All Evidence
        uses: actions/upload-artifact@v4
        with:
          name: openai-full-results
          path: |
            nuclei_results.txt
            unreleased_intel.txt
            priority_targets.txt
            params_*.json
            
