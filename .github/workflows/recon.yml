name: Bug Bounty Recon
on:
  workflow_dispatch: # Allows you to start it from n8n
  schedule:
    - cron: '0 */6 * * *' # Runs every 6 hours automatically

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Install ProjectDiscovery Tools
        run: |
          go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest
          go install -v github.com/projectdiscovery/httpx/cmd/httpx@latest
          go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest
          sudo mv ~/go/bin/* /usr/local/bin/

      - name: Run Recon
        run: |
          subfinder -d target.com -o subs.txt
          httpx -l subs.txt -o live.txt
          nuclei -l live.txt -severity critical,high -o bugs.txt

      - name: Send results to Discord
        if: success()
        run: |
          curl -X POST -H "Content-Type: application/json" -d "{\"content\": \"Scan complete! Found $(wc -l < bugs.txt) potential bugs.\"}" ${{ secrets.DISCORD_WEBHOOK }}
